<!DOCTYPE html>
<meta charset="UTF-8">
<html>
<head>
    <title></title>
</head>
<body>
    <h1>景點觀光展覽資訊
    <input type="text" id="searchsth"></h1>
    <table id="csie" class="table table-striped table-hover">
        <tr>
            <th>名稱</th>
            <th>地點</th>
            <th>票價</th>
        </tr>
    </table>
    <button onclick="delOldData()">delOldData</button>
    <button onclick="addNewData()">addNewData</button>
    
    <button onclick="previousPage()">上一頁</button>
    <button onclick="nextPage()">下一頁</button>
    <input id="numberPage" type="number" value="1" min="1" max="100">頁
</body>

<script>
    
    var openUrl = "https://cloud.culture.tw/frontsite/trans/SearchShowAction.do?method=doFindTypeJ&category=6";
var xhr= new XMLHttpRequest ();
xhr.open ('GET', openUrl, true);
xhr.send ();
xhr.onreadystatechange = function (){
    if(this.readyState == 4 && this.status == 200){
    dataset = JSON.parse(this.responseText);
    addNewData (dataset);
    }
};

function addNewData(dataset){
var myTable = document.getElementById ("csie");


document.getElementById("searchsth").onchange = function() {mySearchFunction()};
function mySearchFunction() {
    var input, filter, table, tr, td, i, txtValue;
    input = document.getElementById("searchsth");
    filter = input.value.toUpperCase();
    table = document.getElementById("csie");
    tr = table.getElementsByTagName("tr");
    for (i = 1; i < tr.length; i++) {
        td = tr[i].getElementsByTagName("td")[0];
        if (td) {
            txtValue = td.textContent || td.innerText;
            if (txtValue.toUpperCase().indexOf(filter) > -1) {
                tr[i].style.display = "";
            } else {
                tr[i].style.display = "none";
            }
        }
    }
}
function delOldData() {
    var table = document.querySelector('table');
    var rows = table.querySelectorAll('tr');
    for (var i = 1; i < rows.length; i++) {
        rows[i].remove();
    }
}

dataset.forEach(function(data, index) {
    var row = myTable.insertRow(-1);
    row.insertCell(0).innerHTML = data['title'];
    row.insertCell(1).innerHTML = data['showInfo'][0]['location'];
    row.insertCell(2).innerHTML = data['showInfo'][0]['price'];
});
}
       
</script>

</html>
